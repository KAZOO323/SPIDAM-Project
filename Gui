import tkinter as tk
from tkinter import filedialog, messagebox
from app_controller import AppController

class SPIDAMApp:
    def __init__(self, root):
        self.root = root
        self.root.title("SPIDAM - Acoustic Modeling")
        self.controller = AppController(self)
        self.init_ui()

    def init_ui(self):
        # File loading
        self.load_button = tk.Button(self.root, text="Load Audio", command=self.load_audio)
        self.load_button.pack(pady=10)

        # Display RT60
        self.rt60_label = tk.Label(self.root, text="RT60: Not calculated")
        self.rt60_label.pack(pady=10)

        # Exit
        self.exit_button = tk.Button(self.root, text="Exit", command=self.root.quit)
        self.exit_button.pack(pady=10)

    def load_audio(self):
        file_path = filedialog.askopenfilename(filetypes=[("Audio Files", "*.wav *.mp3 *.aac")])
        if file_path:
            rt60 = self.controller.process_audio(file_path)
            if rt60 is not None:
                self.rt60_label.config(text=f"RT60: {rt60:.2f} seconds")
                messagebox.showinfo("Success", f"RT60 calculated: {rt60:.2f} seconds")
            else:
                messagebox.showerror("Error", "Failed to calculate RT60.")

if __name__ == "__main__":
    root = tk.Tk()
    app = SPIDAMApp(root)
    root.mainloop()
